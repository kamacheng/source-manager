# 资源管理后台-后台设计文档

## 0. 文件信息
> **建议文件名**：`资源管理后台-后台设计文档.md`

---

## 1. 资源管理首页

### 1.1 页面入口

| 项目     | 说明                         |
| -------- | ---------------------------- |
| 入口位置 | 侧边栏 → 资源管理 → 资源列表 |

### 1.2 筛选条件

| 筛选项名称 | 输入类型       | 默认值 | 业务规则                           |
| ---------- | -------------- | ------ | ---------------------------------- |
| 搜索关键词 | 文本输入框     | 空     | 可选，支持资源名、显示名称模糊搜索 |
| 资源类型   | 单选下拉框     | 全部   | 可选，支持按图片、视频、音频筛选   |
| 资源分类   | 树形下拉框     | 全部   | 可选，支持按多级分类筛选           |
| 优化状态   | 单选下拉框     | 全部   | 可选，支持按已优化、未优化筛选     |
| 时间范围   | 日期范围选择器 | 空     | 可选，支持按上传时间筛选           |

**筛选项枚举值**：

| 筛选项   | 可选值                          |
| -------- | ------------------------------- |
| 资源类型 | 1. 全部 2. 图片 3. 视频 4. 音频 |
| 优化状态 | 1. 全部 2. 已优化 3. 未优化     |

### 1.3 列表展示

**展示方式**：表格列表，支持分页加载

**列表字段**：

| 序号 | 字段名称 | 字段说明               | 交互行为                  |
| ---- | -------- | ---------------------- | ------------------------- |
| 1    | 选择框   | 用于批量操作           | 点击选中/取消选中资源     |
| 2    | 资源预览 | 图片/视频/音频缩略图   | 点击放大预览              |
| 3    | 资源名称 | 资源的唯一标识符       | 无                        |
| 4    | 显示名称 | 资源的展示名称         | 无                        |
| 5    | 资源类型 | 图片/视频/音频         | 无                        |
| 6    | 分类     | 资源所属分类路径       | 点击跳转到分类详情        |
| 7    | 上传时间 | 资源上传的时间         | 无                        |
| 8    | 上传者   | 上传资源的用户         | 无                        |
| 9    | 优化状态 | 是否已上传ASTC优化版本 | 显示"已优化"/"未优化"标签 |
| 10   | 操作     | 资源的操作按钮组       | 包含编辑、迁移、删除按钮  |

**排序规则**：默认按上传时间倒序排列

**分页设置**：支持20/50/100条/页切换，默认50条/页

### 1.4 页面操作

**简单操作**：

| 按钮名称 | 位置       | 点击行为                               |
| -------- | ---------- | -------------------------------------- |
| 搜索     | 筛选区右侧 | 根据筛选条件刷新列表                   |
| 重置     | 筛选区右侧 | 清空所有筛选条件，恢复默认值           |
| 批量上传 | 列表区上方 | 打开批量上传弹窗                       |
| 批量迁移 | 列表区上方 | 打开批量迁移弹窗（需至少选择一个资源） |
| 分类管理 | 列表区上方 | 打开分类管理弹窗                       |

**详细操作**：

1. 事件【点击"编辑"按钮】
   - 前置判断：无
   - 执行过程：
     - 步骤1：打开【资源编辑弹窗】，显示当前资源信息
     - 步骤2：修改显示名称或分类归属
     - 步骤3：点击【保存】，提交修改
   - 结果反馈：
     - ✅ 成功：提示"资源修改成功"，关闭弹窗并刷新当前页
     - ❌ 失败：提示具体错误原因

2. 事件【点击"迁移"按钮】
   - 前置判断：无
   - 执行过程：
     - 步骤1：打开【资源迁移弹窗】
     - 步骤2：选择目标分类
     - 步骤3：点击【确认迁移】，提交迁移请求
   - 结果反馈：
     - ✅ 成功：提示"资源迁移成功"，关闭弹窗并刷新当前页
     - ❌ 失败：提示具体错误原因

3. 事件【点击"删除"按钮】
   - 前置判断：无
   - 执行过程：
     - 步骤1：弹出确认提示框"确定要删除该资源吗？"
     - 步骤2：点击【确定】，提交删除请求
   - 结果反馈：
     - ✅ 成功：提示"资源删除成功"，关闭提示框并刷新当前页
     - ❌ 失败：提示具体错误原因

4. 事件【点击"批量迁移"按钮】
   - 前置判断：是否至少选择了一个资源
     - ❌ 若未选择：提示"请至少选择一个资源"
     - ✅ 若已选择：打开【批量迁移弹窗】
   - 执行过程：
     - 步骤1：选择目标分类
     - 步骤2：显示影响确认（资源数量、目标路径）
     - 步骤3：点击【确认迁移】，提交批量迁移请求
   - 结果反馈：
     - ✅ 成功：提示"资源批量迁移成功"，关闭弹窗并刷新当前页
     - ❌ 失败：提示具体错误原因，撤销全部改动

---

## 2. 分类管理页

### 2.1 页面入口

| 项目     | 说明                        |
| -------- | --------------------------- |
| 入口位置 | 资源管理首页 → 分类管理按钮 |

### 2.2 筛选条件

| 筛选项名称 | 输入类型   | 默认值 | 业务规则                             |
| ---------- | ---------- | ------ | ------------------------------------ |
| 分类名称   | 文本输入框 | 空     | 可选，支持分类名称模糊搜索           |
| 资源类型   | 单选下拉框 | 全部   | 可选，支持按图片、视频、音频分类筛选 |

### 2.3 列表展示

**展示方式**：树形结构列表

**列表字段**：

| 序号 | 字段名称  | 字段说明         | 交互行为                       |
| ---- | --------- | ---------------- | ------------------------------ |
| 1    | 展开/收起 | 展开或收起子分类 | 点击展开/收起树形结构          |
| 2    | 分类名称  | 分类的显示名称   | 无                             |
| 3    | 资源数量  | 分类下的资源数量 | 点击跳转到资源列表并筛选该分类 |
| 4    | 操作      | 分类的操作按钮组 | 包含新增子分类、编辑、删除按钮 |

### 2.4 页面操作

**简单操作**：

| 按钮名称   | 位置       | 点击行为                     |
| ---------- | ---------- | ---------------------------- |
| 新增根分类 | 列表区上方 | 打开新增根分类表单           |
| 搜索       | 筛选区右侧 | 根据筛选条件刷新列表         |
| 重置       | 筛选区右侧 | 清空所有筛选条件，恢复默认值 |

**详细操作**：

1. 事件【点击"新增子分类"按钮】
   - 前置判断：检查当前分类下是否有资源
     - ❌ 若有资源：提示"该分类下有资源，请先迁移资源后再添加子分类"
     - ✅ 若无资源：打开新增子分类表单
   - 执行过程：
     - 步骤1：输入子分类名称和文件夹名称
     - 步骤2：点击【保存】，提交新增请求
   - 结果反馈：
     - ✅ 成功：提示"子分类添加成功"，关闭表单并刷新当前页
     - ❌ 失败：提示具体错误原因（如分类名重复）

2. 事件【点击"编辑"按钮】
   - 前置判断：无
   - 执行过程：
     - 步骤1：打开【分类编辑弹窗】，显示当前分类信息
     - 步骤2：修改分类名称或文件夹名称
     - 步骤3：点击【保存】，提交修改
   - 结果反馈：
     - ✅ 成功：提示"分类修改成功"，关闭弹窗并刷新当前页
     - ❌ 失败：提示具体错误原因（如分类名重复）

3. 事件【点击"删除"按钮】
   - 前置判断：检查分类下是否有子分类或资源
     - ❌ 若有子分类：提示"无法删除，该分类下仍有子分类"
     - ❌ 若有资源：提示"无法删除，该分类下仍有资源，请先迁移"
     - ✅ 若为空：弹出确认提示框"确定要删除该分类吗？"
   - 执行过程：
     - 步骤1：点击【确定】，提交删除请求
   - 结果反馈：
     - ✅ 成功：提示"分类删除成功"，关闭提示框并刷新当前页
     - ❌ 失败：提示具体错误原因

---

## 3. 批量上传弹窗

### 3.1 页面入口

| 项目     | 说明                        |
| -------- | --------------------------- |
| 入口位置 | 资源管理首页 → 批量上传按钮 |

### 3.2 弹窗内容

**上传区域**：
- 文件拖拽区域：支持拖拽文件上传
- 文件选择按钮：支持点击选择文件
- 已选择文件列表：显示已选择的文件信息

**上传设置**：

| 设置项名称 | 输入类型   | 默认值       | 业务规则                                |
| ---------- | ---------- | ------------ | --------------------------------------- |
| 目标分类   | 树形选择器 | 当前选中分类 | 必选，选择资源上传的目标分类            |
| 上传模式   | 单选按钮组 | 仅原始资源   | 可选，支持"仅原始资源"或"原始+ASTC优化" |

### 3.3 页面操作

1. 事件【点击"开始上传"按钮】
   - 前置判断：是否已选择文件
     - ❌ 若未选择：提示"请选择要上传的文件"
     - ✅ 若已选择：开始上传文件
   - 执行过程：
     - 步骤1：验证文件格式和大小
     - 步骤2：验证资源名称是否符合规则（禁止以下划线开头）
     - 步骤3：批量上传文件到服务器
     - 步骤4：关联原始资源和ASTC优化版本（如有）
   - 结果反馈：
     - ✅ 成功：提示"文件上传成功"，关闭弹窗并刷新资源列表
     - ❌ 失败：提示具体错误原因，显示上传失败的文件列表

2. 事件【点击"取消"按钮】
   - 前置判断：无
   - 执行过程：关闭弹窗，清除已选择的文件
   - 结果反馈：无

---

## 4. 资源预览弹窗

### 4.1 页面入口

| 项目     | 说明                          |
| -------- | ----------------------------- |
| 入口位置 | 资源管理首页 → 点击资源缩略图 |

### 4.2 弹窗内容

**预览区域**：
- 图片：显示原始尺寸图片
- 视频：支持播放、暂停、进度条控制
- 音频：支持播放、暂停、进度条控制

**资源信息**：

| 信息项   | 说明                                |
| -------- | ----------------------------------- |
| 资源名称 | 资源的唯一标识符                    |
| 显示名称 | 资源的展示名称                      |
| 资源类型 | 图片/视频/音频                      |
| 分类     | 资源所属分类路径                    |
| 上传时间 | 资源上传的时间                      |
| 上传者   | 上传资源的用户                      |
| 优化状态 | 是否已上传ASTC优化版本              |
| 文件大小 | 资源文件的大小                      |
| 图片尺寸 | 图片的宽度和高度（仅图片）          |
| 时长     | 视频或音频的播放时长（仅视频/音频） |

### 4.3 页面操作

**简单操作**：

| 按钮名称 | 位置       | 点击行为     |
| -------- | ---------- | ------------ |
| 关闭     | 弹窗右上角 | 关闭预览弹窗 |

---

## 5. 资源编辑弹窗

### 5.1 页面入口

| 项目     | 说明                          |
| -------- | ----------------------------- |
| 入口位置 | 资源管理首页 → 点击"编辑"按钮 |

### 5.2 弹窗内容

**编辑表单**：

| 字段名称 | 输入类型   | 业务规则                     |
| -------- | ---------- | ---------------------------- |
| 显示名称 | 文本输入框 | 可选，支持修改资源的展示名称 |
| 分类     | 树形选择器 | 可选，支持修改资源的分类归属 |

### 5.3 页面操作

1. 事件【点击"保存"按钮】
   - 前置判断：无
   - 执行过程：
     - 步骤1：验证输入信息
     - 步骤2：提交修改请求
   - 结果反馈：
     - ✅ 成功：提示"资源修改成功"，关闭弹窗并刷新资源列表
     - ❌ 失败：提示具体错误原因

2. 事件【点击"取消"按钮】
   - 前置判断：无
   - 执行过程：关闭弹窗，放弃修改
   - 结果反馈：无

---

## 6. 资源迁移弹窗

### 6.1 页面入口

| 项目     | 说明                          |
| -------- | ----------------------------- |
| 入口位置 | 资源管理首页 → 点击"迁移"按钮 |

### 6.2 弹窗内容

**迁移设置**：

| 设置项名称 | 输入类型   | 默认值 | 业务规则                     |
| ---------- | ---------- | ------ | ---------------------------- |
| 目标分类   | 树形选择器 | 空     | 必选，选择资源迁移的目标分类 |

**影响范围**：
- 显示当前资源的数量和目标路径

### 6.3 页面操作

1. 事件【点击"确认迁移"按钮】
   - 前置判断：是否已选择目标分类
     - ❌ 若未选择：提示"请选择目标分类"
     - ✅ 若已选择：提交迁移请求
   - 执行过程：
     - 步骤1：验证目标分类是否存在
     - 步骤2：执行资源迁移
   - 结果反馈：
     - ✅ 成功：提示"资源迁移成功"，关闭弹窗并刷新资源列表
     - ❌ 失败：提示具体错误原因

2. 事件【点击"取消"按钮】
   - 前置判断：无
   - 执行过程：关闭弹窗，放弃迁移
   - 结果反馈：无

---

## 7. 批量迁移弹窗

### 7.1 页面入口

| 项目     | 说明                              |
| -------- | --------------------------------- |
| 入口位置 | 资源管理首页 → 点击"批量迁移"按钮 |

### 7.2 弹窗内容

**迁移设置**：

| 设置项名称 | 输入类型   | 默认值 | 业务规则                     |
| ---------- | ---------- | ------ | ---------------------------- |
| 目标分类   | 树形选择器 | 空     | 必选，选择资源迁移的目标分类 |

**影响范围**：
- 显示已选择资源的数量和目标路径

### 7.3 页面操作

1. 事件【点击"确认迁移"按钮】
   - 前置判断：是否已选择目标分类
     - ❌ 若未选择：提示"请选择目标分类"
     - ✅ 若已选择：提交批量迁移请求
   - 执行过程：
     - 步骤1：验证目标分类是否存在
     - 步骤2：验证所有选中资源是否为同一类型
     - 步骤3：执行批量资源迁移
     - 步骤4：记录操作日志
   - 结果反馈：
     - ✅ 成功：提示"资源批量迁移成功"，关闭弹窗并刷新资源列表
     - ❌ 失败：提示具体错误原因，撤销全部改动

2. 事件【点击"取消"按钮】
   - 前置判断：无
   - 执行过程：关闭弹窗，放弃批量迁移
   - 结果反馈：无

---

## 8. 操作日志页面

### 8.1 页面入口

| 项目     | 说明                         |
| -------- | ---------------------------- |
| 入口位置 | 侧边栏 → 系统管理 → 操作日志 |

### 8.2 筛选条件

| 筛选项名称 | 输入类型       | 默认值 | 业务规则                   |
| ---------- | -------------- | ------ | -------------------------- |
| 操作人     | 文本输入框     | 空     | 可选，按操作人姓名模糊搜索 |
| 操作类型   | 多选下拉框     | 全部   | 可选，按操作类型筛选       |
| 时间范围   | 日期范围选择器 | 今日   | 可选，按操作时间筛选       |

**筛选项枚举值**：

| 筛选项   | 可选值                                                                                                  |
| -------- | ------------------------------------------------------------------------------------------------------- |
| 操作类型 | 1. 全部 2. 新增资源 3. 编辑资源 4. 删除资源 5. 批量上传 6. 批量迁移 7. 新增分类 8. 编辑分类 9. 删除分类 |

### 8.3 列表展示

**展示方式**：表格列表，支持分页加载

**列表字段**：

| 序号 | 字段名称 | 字段说明           | 交互行为 |
| ---- | -------- | ------------------ | -------- |
| 1    | 操作时间 | 操作发生的时间     | 无       |
| 2    | 操作人   | 执行操作的用户     | 无       |
| 3    | 操作类型 | 操作的类型         | 无       |
| 4    | 操作详情 | 操作的具体内容     | 无       |
| 5    | IP地址   | 操作人使用的IP地址 | 无       |

**排序规则**：默认按操作时间倒序排列

**分页设置**：支持20/50/100条/页切换，默认50条/页

### 8.4 页面操作

**简单操作**：

| 按钮名称 | 位置       | 点击行为                     |
| -------- | ---------- | ---------------------------- |
| 查询     | 筛选区右侧 | 根据筛选条件刷新列表         |
| 重置     | 筛选区右侧 | 清空所有筛选条件，恢复默认值 |
