## 0. 文件信息
> **建议文件名**：`资源管理后台-设计文档.md`
> **文档版本**：v2.0
> **编写日期**：2026-01-19
> **更新说明**：基于实际代码实现和需求分析文档更新

## 1. 整体布局

### 1.1 页面结构

**主界面采用三栏布局**：

- **左侧栏（固定宽度280px）**：资源类型快速切换（图片/视频/音频）
- **中间栏（固定宽度340px）**：分类树形结构展示与管理
- **右侧栏（自适应宽度）**：资源列表卡片展示区

### 1.2 顶部操作栏

| 按钮名称 | 位置 | 点击行为 | 快捷键 |
| --- | --- | --- | --- |
| 批量上传 | 左侧 | 打开批量上传弹窗 | Ctrl+U |
| 分类管理 | 左侧 | 打开分类管理弹窗 | Ctrl+M |
| 批量迁移 | 中间 | 打开批量迁移弹窗（需至少选择一个资源） | - |
| 全选 | 中间 | 选择/取消选择当前分类下所有资源 | Ctrl+A |
| 操作日志 | 右侧 | 打开操作日志侧边栏 | - |
| 数据统计 | 右侧 | 显示资源统计信息 | - |

## 2. 左侧栏：资源类型切换

### 2.1 展示内容

**资源类型卡片**（3个）：

| 字段名称 | 字段说明 | 交互行为 |
| --- | --- | --- |
| 类型图标 | 图片/视频/音频对应图标 | 无 |
| 类型名称 | IMAGE / VIDEO / AUDIO | 点击切换到该类型资源 |
| 资源数量 | 该类型下的资源总数 | 无 |
| 背景色 | 图片(绿色) / 视频(蓝色) / 音频(琥珀色) | 选中时背景加深 |

### 2.2 交互行为

**事件【点击资源类型卡片】**：
- 前置判断：无
- 执行过程：
  - 步骤1：切换当前资源类型过滤
  - 步骤2：自动展开中间栏该类型的根分类
  - 步骤3：刷新右侧资源列表
- 结果反馈：无

## 3. 中间栏：分类树形结构

### 3.1 展示内容

**树形分类列表**：

| 字段名称 | 字段说明 | 交互行为 |
| --- | --- | --- |
| 展开/收起图标 | 箭头图标，有子分类时显示 | 点击展开/收起子分类 |
| 分类图标 | 文件夹图标（FolderOpen）或标签图标（Tag） | 无 |
| 分类名称 | 分类的显示名称 | 点击选择该分类，右侧显示该分类下资源 |
| 资源数量 | 该分类下的资源数量（灰色小文字） | 无 |

**特殊状态**：
- 选中分类：蓝色背景高亮
- Hover状态：浅灰色背景
- 无资源分类：资源数量显示为0

### 3.2 交互行为

**事件【点击分类名称】**：
- 前置判断：无
- 执行过程：
  - 步骤1：选中该分类（蓝色高亮）
  - 步骤2：右侧资源列表切换为该分类下的资源
  - 步骤3：记录到最近访问分类
- 结果反馈：无

**事件【点击展开/收起图标】**：
- 前置判断：检查是否有子分类
- 执行过程：
  - 步骤1：切换该分类的展开/收起状态
  - 步骤2：显示/隐藏子分类列表
- 结果反馈：无

## 4. 右侧栏：资源卡片列表

### 4.1 筛选栏

| 筛选项名称 | 输入类型 | 默认值 | 业务规则 |
| --- | --- | --- | --- |
| 优化状态 | 下拉选择 | 全部 | 可选：全部/已优化/未优化（仅图片显示） |

### 4.2 资源卡片展示

**卡片布局**：网格布局，每行3-4个卡片（自适应）

**卡片字段**：

| 区域 | 字段名称 | 字段说明 | 交互行为 |
| --- | --- | --- | --- |
| 左上角 | 选择框 | 多选复选框 | 点击选择/取消选择 |
| 顶部预览区 | 资源预览 | 图片直接显示，视频/音频显示图标 | 无 |
| 预览区右上 | 类型标签 | IMAGE/VIDEO/AUDIO标签 | 无 |
| 预览区右下 | 优化标签 | 已优化（绿色）/未优化（红色），仅图片显示 | 无 |
| 信息区 | 分类标签 | 所属分类名称 | 无 |
| 信息区 | 显示名称 | 资源展示名称 | 无 |
| 信息区 | 资源Key | resourceKey（灰色小字） | 无 |
| 信息区 | 上传时间 | 上传时间（YYYY-MM-DD HH:mm:ss） | 无 |
| 信息区 | 上传者 | 上传用户 | 无 |
| 右下角 | 操作按钮 | 复制、编辑、删除按钮 | 点击触发对应操作 |

**标签颜色规则**：
- 类型标签：图片(绿色) / 视频(蓝色) / 音频(琥珀色)
- 优化标签：已优化(绿色) / 未优化(红色)
- 分类标签：根据分类类型动态配色

### 4.3 操作行为

**事件【点击复制按钮】**：
- 前置判断：无
- 执行过程：
  - 步骤1：复制resourceKey到剪贴板
  - 步骤2：显示成功提示"已复制: {resourceKey}"
- 结果反馈：显示通知气泡

**事件【点击编辑按钮】**：
- 前置判断：无
- 执行过程：
  - 步骤1：打开资源详情编辑弹窗
  - 步骤2：加载资源当前信息
- 结果反馈：弹出编辑弹窗

**事件【点击删除按钮】**：
- 前置判断：无
- 执行过程：
  - 步骤1：弹出删除确认弹窗
  - 步骤2：点击确认后删除资源及关联优化版本
- 结果反馈：
  - ✅ 成功：提示"资源删除成功"，刷新列表
  - ❌ 失败：提示具体错误原因

## 5. 分类管理弹窗

### 5.1 弹窗结构

- **顶部**：标题"分类管理"、关闭按钮
- **左侧**：资源类型切换（图片/视频/音频）
- **中间**：当前类型的分类树形结构
- **右侧**：添加根分类/子分类表单区

### 5.2 树形分类操作

**每个分类节点包含**：

| 字段名称 | 字段说明 | 交互行为 |
| --- | --- | --- |
| 展开/收起图标 | 箭头图标 | 点击展开/收起 |
| 分类图标 | 文件夹图标 | 无 |
| 分类名称 | label字段 | 无 |
| 文件夹名 | folder字段（灰色小字） | 无 |
| 资源数量 | 该分类下资源数 | 无 |
| 操作按钮 | 添加子分类、重命名、删除 | 点击触发操作 |

### 5.3 操作行为

**事件【添加根分类】**：
- 前置判断：无
- 执行过程：
  - 步骤1：显示添加根分类表单（分类名称、文件夹名）
  - 步骤2：输入信息后点击"添加根分类"按钮
  - 步骤3：验证名称唯一性
  - 步骤4：添加到分类树顶层
- 结果反馈：
  - ✅ 成功：提示"分类添加成功"，刷新树结构
  - ❌ 失败：提示"分类名已存在"或其他错误

**事件【添加子分类】**：
- 前置判断：需选中父分类
- 执行过程：
  - 步骤1：点击父分类的"添加子分类"按钮
  - 步骤2：在右侧表单区输入子分类信息
  - 步骤3：验证在该父级下名称唯一性
  - 步骤4：添加到父分类children数组
- 结果反馈：
  - ✅ 成功：提示"子分类添加成功"，刷新树结构
  - ❌ 失败：提示"分类名已存在"或其他错误

**事件【重命名分类】**：
- 前置判断：无
- 执行过程：
  - 步骤1：点击分类的"重命名"按钮
  - 步骤2：弹出内联编辑框
  - 步骤3：修改分类名称和文件夹名
  - 步骤4：验证同级唯一性
  - 步骤5：更新分类信息
- 结果反馈：
  - ✅ 成功：提示"分类重命名成功"
  - ❌ 失败：提示"分类名已存在"

**事件【删除分类】**：
- 前置判断：检查是否有子分类或资源
  - ❌ 有子分类：提示"该分类包含子分类，无法删除"
  - ❌ 有资源：提示"该分类包含{count}个资源，无法删除"
  - ✅ 为空：继续执行删除
- 执行过程：
  - 步骤1：弹出删除确认弹窗
  - 步骤2：点击确认后从父分类children中移除
- 结果反馈：
  - ✅ 成功：提示"分类删除成功"
  - ❌ 失败：提示具体错误原因

### 5.4 分类数据结构

```javascript
{
    id: 'category_id',           // 分类唯一标识
    label: '分类名称',            // 显示名称
    folder: 'folder_name',       // 文件夹名（用于路径生成）
    children: []                 // 子分类数组（无限嵌套）
}
```

## 6. 资源编辑弹窗

### 6.1 弹窗结构

- **顶部**：标题"资源详情"、关闭按钮
- **内容区**：
  - 左侧：资源预览区（图片/视频/音频）+ 文件上传区
  - 右侧：资源信息表单

### 6.2 表单字段

| 字段名称 | 字段类型 | 是否必填 | 可编辑性 | 说明 |
| --- | --- | --- | --- | --- |
| 资源Key | 文本输入框 | 是 | ❌ 禁用 | 系统生成，不可修改，灰色背景 |
| 显示名称 | 文本输入框 | 否 | ✅ 可编辑 | 用户自定义展示名称 |
| 上传者 | 文本输入框 | 否 | ❌ 禁用 | 显示当前用户，灰色背景 |
| 逻辑路径 | 文本输入框 | 否 | ❌ 禁用 | 根据分类自动生成，灰色背景 |
| 物理路径 | 文本输入框 | 否 | ❌ 禁用 | UUID路径，固定不变，灰色背景 |
| 已上传ASTC优化版本 | 复选框 | 否 | ❌ 禁用 | 系统设置，不可手动更改 |

### 6.3 操作行为

**事件【保存修改】**：
- 前置判断：无
- 执行过程：
  - 步骤1：验证必填字段
  - 步骤2：更新资源信息（仅可编辑字段）
  - 步骤3：保留只读字段原值
- 结果反馈：
  - ✅ 成功：提示"资源保存成功"，关闭弹窗
  - ❌ 失败：提示具体错误原因

**事件【更换文件】**：
- 前置判断：无
- 执行过程：
  - 步骤1：点击预览区或拖拽新文件
  - 步骤2：上传新文件
  - 步骤3：更新资源URL和物理路径
- 结果反馈：
  - ✅ 成功：预览区显示新文件
  - ❌ 失败：提示上传失败原因

## 7. 批量上传弹窗

### 7.1 弹窗结构

- **顶部**：标题"批量上传资源"、关闭按钮
- **左侧**：文件上传区（支持拖拽）
- **中间**：上传队列列表
- **右侧**：批量设置区（分类选择、优化选项）

### 7.2 上传队列展示

**队列列表字段**：

| 字段名称 | 字段说明 |
| --- | --- |
| 文件名 | 原始文件名 |
| 文件类型 | 图片/视频/音频 |
| 文件大小 | 带单位显示 |
| 上传状态 | 等待中/上传中/成功/失败 |
| 进度条 | 上传进度百分比 |
| 操作按钮 | 移除按钮（未上传时可点击） |

### 7.3 操作行为

**事件【选择文件】**：
- 前置判断：无
- 执行过程：
  - 步骤1：点击上传区或拖拽文件
  - 步骤2：验证文件类型（图片/视频/音频）
  - 步骤3：验证文件大小
  - 步骤4：添加到上传队列
- 结果反馈：
  - ✅ 成功：文件显示在队列中
  - ❌ 失败：提示文件类型或大小不符

**事件【开始上传】**：
- 前置判断：检查队列是否为空
- 执行过程：
  - 步骤1：验证所有文件的resourceKey唯一性
  - 步骤2：依次上传队列中的文件
  - 步骤3：显示每个文件的上传进度
  - 步骤4：上传成功后更新资源列表
- 结果反馈：
  - ✅ 成功：提示"上传成功{count}个文件"
  - ⚠️ 部分成功：提示"成功{success}个，失败{fail}个"
  - ❌ 全部失败：提示具体错误原因

## 8. 批量迁移弹窗

### 8.1 弹窗结构

- **顶部**：标题"批量迁移资源"、关闭按钮
- **左侧**：已选择资源列表（树形结构，按分类分组）
- **右侧**：目标分类选择器（树形选择）

### 8.2 已选资源展示

**树形资源列表**：

| 字段名称 | 字段说明 |
| --- | --- |
| 分类节点 | 原分类名称（作为分组） |
| 资源名称 | displayName |
| 资源Key | resourceKey（灰色小字） |
| 资源数量 | 每个分类下的资源数量 |

**特性**：
- 按原分类分组展示
- 显示每个分类下的资源数量
- 可展开/收起各分类组

### 8.3 目标分类选择

**树形分类选择器**：
- 显示当前资源类型的完整分类树
- 点击分类节点选中该分类
- 选中分类高亮显示
- 显示目标路径预览

### 8.4 操作行为

**事件【确认迁移】**：
- 前置判断：检查是否已选择目标分类
  - ❌ 未选择：提示"请选择目标分类"
- 执行过程：
  - 步骤1：点击"确认迁移"按钮
  - 步骤2：显示影响确认弹窗
    - 显示将要迁移的资源数量
    - 显示目标分类路径
    - 按原分类分组显示迁移详情
  - 步骤3：点击"执行迁移"按钮
  - 步骤4：批量更新资源的category字段
  - 步骤5：更新逻辑路径
- 结果反馈：
  - ✅ 成功：提示"成功迁移{count}个资源"，刷新列表
  - ❌ 失败：提示具体错误原因，不执行任何改动

## 9. 操作日志侧边栏

### 9.1 展示内容

**日志列表字段**：

| 字段名称 | 字段说明 |
| --- | --- |
| 操作时间 | YYYY-MM-DD HH:mm:ss |
| 操作类型 | 新增/编辑/删除/迁移 |
| 操作对象 | 资源名称或分类名称 |
| 操作详情 | 操作的具体描述 |
| 操作人 | 执行操作的用户 |

### 9.2 日志类型

| 操作类型 | 日志格式 |
| --- | --- |
| 新增分类 | 新增分类：{分类名称} |
| 重命名分类 | 重命名分类：{旧名称} → {新名称} |
| 删除分类 | 删除分类：{分类名称} |
| 上传资源 | 上传资源：{resourceKey} 到 {分类} |
| 编辑资源 | 编辑资源：{resourceKey} |
| 删除资源 | 删除资源：{resourceKey} |
| 迁移资源 | 迁移资源：{count}个资源从 {原分类} 到 {目标分类} |

### 9.3 操作行为

**事件【查看日志详情】**：
- 前置判断：无
- 执行过程：
  - 步骤1：点击日志条目
  - 步骤2：展开显示详细信息
- 结果反馈：无

## 10. 快捷键支持

| 快捷键 | 功能 | 适用场景 |
| --- | --- | --- |
| Ctrl + U | 打开批量上传弹窗 | 全局 |
| Ctrl + M | 打开分类管理弹窗 | 全局 |
| Ctrl + A | 全选当前分类下资源 | 资源列表 |
| Esc | 关闭当前弹窗 | 任何打开的弹窗 |
| Delete | 删除选中资源 | 已选择资源时 |

## 11. 数据统计面板

### 11.1 展示内容

**统计卡片**：

| 统计项 | 说明 |
| --- | --- |
| 总资源数 | 所有资源总数 |
| 图片资源数 | 图片类型资源数 + 百分比 |
| 视频资源数 | 视频类型资源数 + 百分比 |
| 音频资源数 | 音频类型资源数 + 百分比 |
| 已优化图片 | 已优化图片数 / 图片总数 |
| 分类总数 | 所有分类节点数（含子分类） |
| 今日上传 | 今天上传的资源数 |

## 12. 通知系统

### 12.1 通知类型

| 类型 | 颜色 | 图标 | 持续时间 |
| --- | --- | --- | --- |
| 成功 | 绿色 | CheckCircle | 3秒 |
| 错误 | 红色 | XCircle | 5秒 |
| 警告 | 黄色 | AlertCircle | 4秒 |
| 信息 | 蓝色 | Info | 3秒 |

### 12.2 通知位置

- 位置：页面右上角
- 动画：从右侧滑入，自动淡出
- 堆叠：多个通知垂直堆叠显示

## 13. 响应式设计

### 13.1 断点设置

| 断点名称 | 屏幕宽度 | 布局调整 |
| --- | --- | --- |
| 大屏 | ≥1920px | 三栏完整显示，资源卡片4列 |
| 中屏 | 1280px-1919px | 三栏完整显示，资源卡片3列 |
| 小屏 | <1280px | 左侧栏可收起，资源卡片2列 |

### 13.2 移动端适配

- 左侧栏和中间栏折叠为抽屉式导航
- 资源卡片单列显示
- 操作按钮显示为图标模式

## 14. 性能优化

### 14.1 列表渲染

- 使用虚拟滚动（超过100个资源时）
- 资源卡片懒加载预览图
- 分类树延迟渲染子节点

### 14.2 数据处理

- 防抖搜索（300ms延迟）
- 分类切换缓存当前滚动位置
- 批量操作进度实时更新

## 15. 错误处理

### 15.1 网络错误

- 上传失败：显示重试按钮
- 加载失败：显示重新加载提示
- 超时处理：自动重试3次

### 15.2 用户操作错误

- 表单验证：实时提示错误字段
- 批量操作：详细列出失败项
- 分类冲突：高亮显示冲突位置
